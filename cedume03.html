<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>어휘끝 중학필수 단어 시험 (Unit 21-30)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .correct-flash { animation: flash-green 0.5s; }
        .incorrect-flash { animation: flash-red 0.5s; }
        @keyframes flash-green { 50% { box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.5); } }
        @keyframes flash-red { 50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.5); } }
        #toast { transition: opacity 0.3s, transform 0.3s; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen font-sans">
    <div id="app-container" class="w-full max-w-2xl mx-auto bg-white shadow-xl rounded-lg p-4 sm:p-8">
        <div id="user-info-screen">
            <h1 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">사용자 정보 입력</h1>
            <p class="text-center text-gray-600 mb-8">결과 저장에 사용될 정보를 입력해주세요.</p>
            <div class="space-y-4">
                <div><label for="school-input" class="block text-sm font-medium text-gray-700">학교</label><input type="text" id="school-input" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm" placeholder="예: 새싹중학교"></div>
                <div><label for="grade-input" class="block text-sm font-medium text-gray-700">학년</label><input type="text" id="grade-input" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm" placeholder="예: 1"></div>
                <div><label for="name-input" class="block text-sm font-medium text-gray-700">이름</label><input type="text" id="name-input" class="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm" placeholder="예: 홍길동"></div>
            </div>
            <button id="start-app-button" class="w-full mt-8 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700">시험 시작하기</button>
        </div>
        <div id="unit-selection-screen" class="hidden">
            <h1 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">어휘끝 중학필수 단어 시험</h1>
            <p class="text-center text-gray-600 mb-8">시험 볼 유닛을 선택하세요. (Unit 21-30)</p>
            <div id="unit-buttons" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
        </div>
        <div id="test-screen" class="hidden">
            <div class="flex justify-between items-center mb-6"><h2 id="test-title" class="text-xl sm:text-2xl font-bold"></h2><div id="timer" class="text-lg font-semibold text-red-500 bg-red-100 px-4 py-2 rounded-lg">10:00</div></div>
            <div class="mb-6"><div class="w-full bg-gray-200 rounded-full h-2.5"><div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full"></div></div><p id="progress-text" class="text-center text-sm text-gray-600 mt-2"></p></div>
            <div id="question-container" class="text-center p-6 bg-gray-50 rounded-lg"><p id="question-type" class="text-sm font-semibold text-blue-600 mb-2"></p><p id="question" class="text-2xl sm:text-3xl font-medium mb-6 min-h-[72px] flex items-center justify-center"></p><input type="text" id="answer-input" class="w-full p-3 border rounded-lg text-lg text-center" placeholder="정답을 입력하세요"></div>
            <button id="next-button" class="w-full mt-6 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700">다음</button>
        </div>
        <div id="results-screen" class="hidden">
            <h2 class="text-2xl sm:text-3xl font-bold text-center mb-4">시험 결과</h2>
            <div id="score-container" class="text-5xl font-bold text-center py-8 mb-6 rounded-lg"><span id="final-score"></span><span class="text-3xl text-gray-500"> / 100</span></div>
            <h3 class="text-lg font-semibold mb-4">틀린 문제 목록</h3>
            <div class="overflow-x-auto border rounded-lg max-h-64">
                <table class="min-w-full divide-y"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-4 py-3 text-left text-xs font-medium uppercase">문제</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">제출한 답</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">정답</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">점수</th></tr></thead><tbody id="incorrect-answers-body" class="bg-white divide-y"></tbody></table>
            </div>
            <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <button id="save-results-button" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg">결과 저장</button>
                <button id="retry-button" class="w-full bg-blue-500 text-white font-bold py-3 rounded-lg">다시 풀기</button>
                <button id="home-button" class="w-full bg-gray-500 text-white font-bold py-3 rounded-lg">처음으로</button>
            </div>
        </div>
    </div>
    <div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white px-5 py-3 rounded-lg shadow-lg opacity-0 transform translate-y-5"></div>
    <script>
        const vocabularyData = {
            "Unit 21": [ { word: "male", meaning: "남성; 수컷" }, { word: "female", meaning: "여성; 암컷" }, { word: "lady", meaning: "여성, 숙녀" }, { word: "gentleman", meaning: "신사" }, { word: "prince", meaning: "왕자" }, { word: "princess", meaning: "공주" }, { word: "adult", meaning: "성인, 어른" }, { word: "elderly", meaning: "연세가 드신; 어르신들, 연세 드신 분들" }, { word: "captain", meaning: "선장, (항공기의) 기장; (스포츠 팀의) 주장" }, { word: "chief", meaning: "(조직·단체의) 장, 우두머리; 주된, 가장 중요한" }, { word: "expert", meaning: "전문가" }, { word: "master", meaning: "주인, 지배자; 달인, 명수" }, { word: "owner", meaning: "주인, 소유주" }, { word: "guest", meaning: "(가정집이나 행사의) 손님, 하객" }, { word: "partner", meaning: "동반자; 파트너, 동업자" }, { word: "beggar", meaning: "거지" }, { word: "everyone", meaning: "모든 사람, 모두" }, { word: "someone", meaning: "어떤 사람, 누군가" }, { word: "anyone", meaning: "누구, 아무" }, { word: "nobody", meaning: "아무도 …않다, 한 사람도 …않다" }, { word: "person", meaning: "(개개의) 사람, 개인" }, { word: "guy", meaning: "남자; (남녀 구분 없이) 사람들, 여러분" }, { word: "rival", meaning: "경쟁자, 경쟁 상대" }, { word: "neighbor", meaning: "이웃(사람)" }, { word: "resident", meaning: "거주자, 주민" } ],
            "Unit 22": [ { word: "job", meaning: "일, 직장, 일자리" }, { word: "occupation", meaning: "직업" }, { word: "nurse", meaning: "간호사" }, { word: "dentist", meaning: "치과 의사, 치과" }, { word: "vet", meaning: "수의사" }, { word: "artist", meaning: "화가, 예술가" }, { word: "painter", meaning: "화가; 페인트공" }, { word: "musician", meaning: "음악가" }, { word: "actor", meaning: "배우" }, { word: "director", meaning: "(영화·연극의) 감독, 연출가" }, { word: "clerk", meaning: "(회사) 사무원, 직원; (가게) 점원" }, { word: "cashier", meaning: "계산원, 점원" }, { word: "secretary", meaning: "비서, 서기" }, { word: "driver", meaning: "운전사, 기사" }, { word: "pilot", meaning: "조종사, 비행사" }, { word: "flight attendant", meaning: "비행기 승무원" }, { word: "engineer", meaning: "엔지니어, 기술자" }, { word: "mechanic", meaning: "(특히 차량 엔진) 정비공" }, { word: "professor", meaning: "교수" }, { word: "detective", meaning: "형사, 수사관" }, { word: "scientist", meaning: "과학자" }, { word: "writer", meaning: "작가" }, { word: "farmer", meaning: "농부, 농장주" }, { word: "cook", meaning: "요리사; 요리하다" }, { word: "hairdresser", meaning: "미용사" } ],
            "Unit 23": [ { word: "conversation", meaning: "대화" }, { word: "dialog(ue)", meaning: "대화" }, { word: "greet", meaning: "환영하다, 맞이하다" }, { word: "bow", meaning: "(존경의 표시로 고개를) 숙이다 ; 활" }, { word: "introduce", meaning: "소개하다, 들여오다" }, { word: "chat", meaning: "이야기를 나누다" }, { word: "speak", meaning: "이야기하다, 말을 주고받다; 말하다" }, { word: "reply", meaning: "대답; 답장; 대답하다; 답장을 보내다" }, { word: "express", meaning: "표현하다; 급행의" }, { word: "repeat", meaning: "반복하다" }, { word: "praise", meaning: "칭찬, 찬사; 칭찬하다" }, { word: "please", meaning: "부디, 제발; 기쁘게 하다" }, { word: "joke", meaning: "농담, 우스개 소리" }, { word: "accent", meaning: "말씨, 악센트, 억양; 강조; 강조하다" }, { word: "gesture", meaning: "몸짓, 제스처" }, { word: "discuss", meaning: "논의하다, 토론하다" }, { word: "argue", meaning: "말싸움하다, 다투다" }, { word: "subject", meaning: "(논의 등의) 주제, 화제, 대상; 과목" }, { word: "suggest", meaning: "제안하다, 제의하다" }, { word: "advise", meaning: "조언하다, 충고하다" }, { word: "accept", meaning: "받아들이다; 인정하다" }, { word: "agree", meaning: "동의하다" }, { word: "allow", meaning: "허락하다" }, { word: "complain", meaning: "불평하다" }, { word: "mean", meaning: "의미하다; 못된, 심술 궂은" } ],
            "Unit 24": [ { word: "company", meaning: "회사; 동료, 일행" }, { word: "office", meaning: "사무실, 회사" }, { word: "workplace", meaning: "직장, 업무 현장" }, { word: "business", meaning: "사업, 장사; (직장의) 일" }, { word: "manage", meaning: "(힘든 일을) 간신히 해내다; 경영[관리, 감독]하다" }, { word: "boss", meaning: "(직장의) 상사; 사장" }, { word: "employee", meaning: "직원, 근로자 (↔ employer 고용주)" }, { word: "staff", meaning: "직원, 스태프" }, { word: "career", meaning: "경력; 직업" }, { word: "process", meaning: "(특정 결과를 달성하기 위한) 과정, 절차; (원자재 등을) 가공하다, 처리하다; (문서 등을) 처리하다" }, { word: "project", meaning: "기획, 프로젝트" }, { word: "role", meaning: "역할, 배역" }, { word: "record", meaning: "기록하다; 녹화[녹음]하다; 기록; 음반" }, { word: "report", meaning: "보고서; 보도; 알리다, 발표하다" }, { word: "list", meaning: "목록, 명단" }, { word: "send", meaning: "보내다, 발송하다" }, { word: "training", meaning: "(특정 직업·일에 필요한) 교육, 훈련" }, { word: "skill", meaning: "기술, 솜씨" }, { word: "opportunity", meaning: "기회" }, { word: "file", meaning: "파일, 서류철; (문서 등을 정리하여) 보관하다" }, { word: "document", meaning: "문서, 서류" }, { word: "paper", meaning: "종이; 신문" }, { word: "copy", meaning: "복사(본), 복제(본); 복사하다, 베끼다" }, { word: "print", meaning: "인쇄하다; (인쇄된) 활자, 활자체" }, { word: "envelope", meaning: "봉투" } ],
            "Unit 25": [ { word: "economy", meaning: "경제; 절약" }, { word: "wealth", meaning: "부, 재산" }, { word: "cash", meaning: "현금, 돈" }, { word: "dollar(s)", meaning: "<통화 단위> 달러" }, { word: "coin", meaning: "동전" }, { word: "cent(s)", meaning: "<통화 단위> 센트 (100분의 1달러나 유로" }, { word: "penny", meaning: "<통화 단위> 페니 (영국의 화폐단위, 미국의 1센트)" }, { word: "saving", meaning: "저축, 절약" }, { word: "gain", meaning: "얻다" }, { word: "borrow", meaning: "빌리다" }, { word: "lend", meaning: "빌려주다" }, { word: "rich", meaning: "부유한, 돈 많은" }, { word: "poor", meaning: "가난한" }, { word: "value", meaning: "가치; 가격" }, { word: "expense", meaning: "돈, 비용" }, { word: "industry", meaning: "산업, 업계" }, { word: "produce", meaning: "생산하다, 제작하다" }, { word: "provide", meaning: "제공하다, 공급하다" }, { word: "offer", meaning: "제공하다; 제안" }, { word: "trade", meaning: "거래, 무역, 교역; 거래[무역, 교역]하다" }, { word: "deal", meaning: "다루다, 처리하다; 거래하다; 거래(서), (사업상의) 합의" }, { word: "sale", meaning: "판매, 매매; 할인 판매, 세일" }, { word: "price", meaning: "값, 가격; 대가, 희생, 보상" }, { word: "rise", meaning: "오르다, 증가하다; 증가, 상승" }, { word: "risk", meaning: "위험" } ],
            "Unit 26": [ { word: "place", meaning: "장소; 두다, 놓다" }, { word: "address", meaning: "주소; 연설; 주소를 쓰다; 연설하다" }, { word: "space", meaning: "공간, 자리; 우주" }, { word: "area", meaning: "지역; 구역; 분야, 부문" }, { word: "town", meaning: "소도시, 읍(내), 시(내)" }, { word: "village", meaning: "(시골) 마을, 촌락, 부락" }, { word: "build", meaning: "(건물을) 짓다, 건축하다; 만들어 내다" }, { word: "palace", meaning: "궁전" }, { word: "tower", meaning: "탑, 타워" }, { word: "factory", meaning: "공장" }, { word: "airport", meaning: "공항" }, { word: "hospital", meaning: "병원" }, { word: "library", meaning: "도서관; 서재" }, { word: "museum", meaning: "박물관" }, { word: "theater", meaning: "영화관, 극장" }, { word: "market", meaning: "시장" }, { word: "shop", meaning: "가게, 상점; 사다, 쇼핑하다" }, { word: "store", meaning: "가게, 상점; 보관하다, 저장하다" }, { word: "station", meaning: "역, 정거장" }, { word: "beach", meaning: "해변, 바닷가" }, { word: "farm", meaning: "농장, 농원" }, { word: "park", meaning: "공원; 주차하다" }, { word: "toilet", meaning: "화장실; 변기" }, { word: "hall", meaning: "(건물 입구 안쪽의) 현관; 복도; 홀 (회의, 식사, 콘서트 등을 위한 큰 방이나 건물)" }, { word: "main", meaning: "가장 중요한, 주된" } ],
            "Unit 27": [ { word: "train", meaning: "기차, 열차; 연속, 일련; 교육[훈련]시키다, 교육[훈련]받다" }, { word: "subway", meaning: "지하철" }, { word: "truck", meaning: "트럭" }, { word: "bike", meaning: "자전거" }, { word: "cycle", meaning: "자전거를 타다; 자전거, 오토바이; 주기, 순환" }, { word: "cart", meaning: "수레, 마차; 손수레, 카트" }, { word: "plane", meaning: "비행기" }, { word: "ship", meaning: "(큰) 배, 선박, 함선; 실어 나르다, 수송하다" }, { word: "wheel", meaning: "바퀴; (자동차 등의) 핸들" }, { word: "gas", meaning: "기체, 가스; 휘발유" }, { word: "fee", meaning: "요금, 회비" }, { word: "street", meaning: "길거리, 도로" }, { word: "road", meaning: "도로, 길" }, { word: "tunnel", meaning: "터널, 굴" }, { word: "block", meaning: "(나무·돌 등의 사각형) 덩어리, 토막; (도로) 구역, 블록; 막다, 차단하다" }, { word: "bridge", meaning: "다리" }, { word: "connect", meaning: "잇다, 연결하다; (인터넷 등에) 접속하다" }, { word: "cross", meaning: "건너다, 횡단하다; 교차하다, 엇갈리다; ×표; 십자가" }, { word: "ride", meaning: "(탈 것을) 타다; (말을) 타다; (차량 등을) 타고 가기" }, { word: "traffic", meaning: "차량들, 교통(량)" }, { word: "speed", meaning: "속도, 속력" }, { word: "signal", meaning: "신호; 신호를 보내다" }, { word: "stop", meaning: "멈추다, 서다, 정지하다; 멈춤, 중단" }, { word: "wait", meaning: "기다리다" }, { word: "miss", meaning: "놓치다, 빗나가다; 그리워하다" } ],
            "Unit 28": [ { word: "east", meaning: "동쪽, 동부" }, { word: "west", meaning: "서쪽, 서부" }, { word: "south", meaning: "남쪽, 남부" }, { word: "north", meaning: "북쪽, 북부" }, { word: "high", meaning: "높은; 높이가 ~인; 높이, 높은 곳에" }, { word: "over", meaning: "~위쪽에; ~을 건너, 넘어" }, { word: "top", meaning: "맨 위 (부분), 정상, 꼭대기; 윗면; 꼭대기의, 맨 위의, 최고의" }, { word: "bottom", meaning: "아랫부분, 밑바닥" }, { word: "base", meaning: "맨 아랫부분; (이론 등의) 기초, 근거; ~을 기초로 하다, ~을 근거로 하다" }, { word: "low", meaning: "낮은" }, { word: "below", meaning: "(위치가 ~보다) 아래에; 아래에, 밑에" }, { word: "ahead", meaning: "앞쪽에, 앞에; 미리" }, { word: "front", meaning: "앞면, 앞쪽; 앞쪽의" }, { word: "behind", meaning: "(위치가) 뒤에; 뒤에, 뒤떨어져" }, { word: "center/centre", meaning: "중심, 중앙, 가운데; (사람이 모이는) 센터, 중심지" }, { word: "middle", meaning: "중앙, 가운데, 중간; 한가운데의, 중앙의" }, { word: "between", meaning: "(위치가) 사이에, 중간에" }, { word: "side", meaning: "쪽, 측; 옆, 옆면" }, { word: "beside", meaning: "옆에" }, { word: "inside", meaning: "안으로, 내부로; 안쪽, 내부; 내부의, 안쪽의" }, { word: "right", meaning: "오른쪽의, 우측의; 옳은, 정확한; 오른쪽, 우측; 옳은 것; 권리" }, { word: "left", meaning: "왼쪽의, 좌측의; 왼쪽, 좌측" }, { word: "near", meaning: "가까이; 가까운; ~에서 가까이" }, { word: "far", meaning: "멀리, ~ (만큼) 떨어져; 훨씬, 아주, 대단히" }, { word: "corner", meaning: "모퉁이, 모서리; (방·상자의) 구석" } ],
            "Unit 29": [ { word: "society", meaning: "사회" }, { word: "community", meaning: "공동체, 지역사회" }, { word: "belong", meaning: "소유물이다, 속하다" }, { word: "include", meaning: "포함하다" }, { word: "private", meaning: "사적인, 개인에 속한" }, { word: "general", meaning: "일반적인, 보통의; 대체적인, 대강의; (군대의) 대장, 장군" }, { word: "common", meaning: "흔한; 공통의" }, { word: "depend", meaning: "의지하다; ~에 달려 있다" }, { word: "lead", meaning: "인도하다, 이끌다; 앞서다" }, { word: "direct", meaning: "곧장, 직행의; 직접적인; 지도하다, 감독하다" }, { word: "donate", meaning: "기부하다, 기증하다" }, { word: "share", meaning: "함께 쓰다, 공유하다; 몫, 지분" }, { word: "volunteer", meaning: "자원봉사자; 자발적으로 나서다" }, { word: "issue", meaning: "쟁점, 사안; 발행, (잡지·신문의) 호" }, { word: "case", meaning: "상황, 경우; 사건" }, { word: "matter", meaning: "일, 문제; 중요하다" }, { word: "important", meaning: "중요한" }, { word: "trouble", meaning: "문제, 골칫거리; 고생, 수고" }, { word: "prevent", meaning: "막다, 예방하다, 방해하다" }, { word: "happen", meaning: "일어나다, 생기다" }, { word: "handle", meaning: "다루다, 취급하다; 손잡이" }, { word: "solve", meaning: "(문제 등을) 해결하다, 풀다" }, { word: "survey", meaning: "(설문) 조사" }, { word: "affect", meaning: "영향을 미치다" }, { word: "choose", meaning: "선택하다, 고르다" } ],
            "Unit 30": [ { word: "crime", meaning: "범죄, 죄" }, { word: "kill", meaning: "죽이다, 목숨을 빼앗다" }, { word: "cheat", meaning: "속이다, 사기 치다; (시험에서) 부정행위를 하다" }, { word: "steal", meaning: "훔치다, 도둑질하다" }, { word: "thief", meaning: "도둑, 절도범" }, { word: "escape", meaning: "도망치다, 탈출하다; 탈출, 도피" }, { word: "chase", meaning: "뒤쫓다, 추격하다; 추적, 추격" }, { word: "sign", meaning: "징조; 표지판; 서명하다" }, { word: "scene", meaning: "현장; 장면" }, { word: "law", meaning: "법, 법률" }, { word: "rule", meaning: "규칙; 통치; 다스리다" }, { word: "control", meaning: "지배(권); 통제력; 통제하다" }, { word: "force", meaning: "힘, 영향력; 억지로 ~을 시키다, 강요하다" }, { word: "strict", meaning: "엄격한, 엄한" }, { word: "necessary", meaning: "필수적인, 필요한" }, { word: "court", meaning: "법정, 법원; (테니스 등의) 코트, 경기장" }, { word: "judge", meaning: "판사; 심판; 판단하다" }, { word: "lawyer", meaning: "변호사" }, { word: "proof", meaning: "증거, 증명; 견딜 수 있는, 견디는" }, { word: "fair", meaning: "공정한, 공평한; 꽤 많은, 상당한; 박람회, 품평회" }, { word: "true", meaning: "사실인, 맞는; 진짜의, 실제의" }, { word: "false", meaning: "거짓의" }, { word: "punish", meaning: "처벌하다, 벌주다" }, { word: "prison", meaning: "교도소, 감옥" }, { word: "jail", meaning: "교도소, 감옥; 투옥하다" } ]
        };
        // --- 이하 스크립트 코드는 이전과 동일 ---
        let userInfo = {};
        let currentUnit='',questions=[],currentQuestionIndex=0,userAnswers=[],timerInterval;
        const userInfoScreen = document.getElementById('user-info-screen');
        const unitSelectionScreen=document.getElementById('unit-selection-screen');
        const testScreen=document.getElementById('test-screen');
        const resultsScreen=document.getElementById('results-screen');
        const schoolInput = document.getElementById('school-input');
        const gradeInput = document.getElementById('grade-input');
        const nameInput = document.getElementById('name-input');
        const startAppButton = document.getElementById('start-app-button');
        const unitButtonsContainer=document.getElementById('unit-buttons');
        const testTitle=document.getElementById('test-title');
        const timerDisplay=document.getElementById('timer');
        const progressBar=document.getElementById('progress-bar');
        const progressText=document.getElementById('progress-text');
        const questionType=document.getElementById('question-type');
        const questionEl=document.getElementById('question');
        const answerInput=document.getElementById('answer-input');
        const nextButton=document.getElementById('next-button');
        const finalScore=document.getElementById('final-score');
        const incorrectAnswersBody=document.getElementById('incorrect-answers-body');
        const saveResultsButton=document.getElementById('save-results-button');
        const retryButton=document.getElementById('retry-button');
        const homeButton=document.getElementById('home-button');
        
        function init(){
            Object.keys(vocabularyData).sort((a,b)=>parseInt(a.match(/\d+/)[0])-parseInt(b.match(/\d+/)[0])).forEach(unit=>{const button=document.createElement('button');button.textContent=unit;button.className='bg-white text-gray-700 font-semibold py-4 px-2 rounded-lg shadow hover:bg-gray-200 border border-gray-200 transition-all duration-200';button.onclick=()=>startTest(unit);unitButtonsContainer.appendChild(button)});
            startAppButton.addEventListener('click', startApp);
            nextButton.addEventListener('click',handleNext);
            answerInput.addEventListener('keyup',e=>{if(e.key==='Enter'){handleNext()}});
            retryButton.addEventListener('click',()=>startTest(currentUnit));
            homeButton.addEventListener('click',()=>showScreen(unitSelectionScreen));
            saveResultsButton.addEventListener('click',saveResults);
            showScreen(userInfoScreen);
        }

        function startApp() {
            const school = schoolInput.value.trim();
            const grade = gradeInput.value.trim();
            const name = nameInput.value.trim();
            if (!school || !grade || !name) {
                showToast("모든 정보를 입력해주세요.");
                return;
            }
            userInfo = { school, grade, name };
            showScreen(unitSelectionScreen);
        }

        function showScreen(screen){
            [userInfoScreen, unitSelectionScreen,testScreen,resultsScreen].forEach(s=>s.classList.add('hidden'));
            screen.classList.remove('hidden');
        }

        async function saveResults(){
            const score=finalScore.textContent;
            let title = `${userInfo.school} ${userInfo.grade}학년 ${userInfo.name}의 ${currentUnit} 시험지`;
            let resultsText = `${title}\n\n총점: ${score}점\n\n--- 틀린 문제 목록 ---\n`;
            const incorrectRows=incorrectAnswersBody.querySelectorAll('tr');
            if(incorrectRows.length===1&&incorrectRows[0].children[0].colSpan===4){
                resultsText+="틀린 문제가 없습니다."
            } else {
                incorrectRows.forEach(row=>{
                    const cells=row.querySelectorAll('td');
                    resultsText+=`문제: ${cells[0].textContent}\n`;
                    resultsText+=`제출 답: ${cells[1].textContent}\n`;
                    resultsText+=`정답: ${cells[2].textContent}\n`;
                    resultsText+=`점수: ${cells[3].textContent}\n\n`;
                });
            }
            try{
                await navigator.clipboard.writeText(resultsText.trim());
                showToast('시험 결과가 클립보드에 복사되었습니다.');
            } catch(err) {
                console.error('클립보드 복사 실패:',err);
                showToast('결과 복사에 실패했습니다.');
            }
        }
        
        function startTest(unit){currentUnit=unit;let unitWords=[...vocabularyData[unit]];questions=[];userAnswers=[];currentQuestionIndex=0;unitWords.sort(()=>0.5-Math.random());const numQuestions=Math.min(20,unitWords.length);const selectedWords=unitWords.slice(0,numQuestions);const half=Math.ceil(numQuestions/2);for(let i=0;i<numQuestions;i++){const wordData=selectedWords[i];const type=i<half?'spelling':'meaning';questions.push({type:type,word:wordData.word,meaning:wordData.meaning,originalQuestion:type==='spelling'?wordData.meaning:wordData.word})}
        questions.sort(()=>0.5-Math.random());testTitle.textContent=`${unit} 단어 시험`;showScreen(testScreen);displayQuestion();startTimer()}
        function displayQuestion(){if(currentQuestionIndex>=questions.length){submitTest();return}
        const q=questions[currentQuestionIndex];if(q.type==='spelling'){questionType.textContent='의미를 보고 철자 맞히기';questionEl.textContent=q.meaning.replace(/(\d+\.\s*)|[()]/g,'').replace(/;/g,', ')}else{questionType.textContent='철자를 보고 의미 맞히기';questionEl.textContent=q.word}
        answerInput.value='';answerInput.focus();updateProgress();if(currentQuestionIndex===questions.length-1){nextButton.textContent='채점하기'}else{nextButton.textContent='다음'}}
        function handleNext(){const answer=answerInput.value.trim();if(!answer){answerInput.classList.add('incorrect-flash');setTimeout(()=>answerInput.classList.remove('incorrect-flash'),500);return}
        userAnswers[currentQuestionIndex]=answer;const isCorrectAnswer=isAnswerInitiallyCorrect(questions[currentQuestionIndex],answer);answerInput.classList.add(isCorrectAnswer?'correct-flash':'incorrect-flash');setTimeout(()=>answerInput.classList.remove('correct-flash','incorrect-flash'),500);setTimeout(()=>{currentQuestionIndex++;displayQuestion()},300)}
        function isAnswerInitiallyCorrect(question,answer){if(question.type==='spelling'){return question.word.toLowerCase()===answer.toLowerCase()}else{const cleanCorrectAnswer=question.meaning.toLowerCase().replace(/(\d+\.\s*)|[()]/g,'');const userFirstMeaning=answer.split(/[,;]/)[0].toLowerCase().trim();return cleanCorrectAnswer.includes(userFirstMeaning)}}
        function updateProgress(){const progress=((currentQuestionIndex)/questions.length)*100;progressBar.style.width=`${progress}%`;progressText.textContent=`문제 ${currentQuestionIndex+1} / ${questions.length}`}
        function startTimer(){let timeLeft=600;timerDisplay.textContent="10:00";clearInterval(timerInterval);timerInterval=setInterval(()=>{timeLeft--;const minutes=Math.floor(timeLeft/60);const seconds=timeLeft%60;timerDisplay.textContent=`${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;if(timeLeft<=0){clearInterval(timerInterval);submitTest()}},1000)}
        function submitTest(){clearInterval(timerInterval);let totalScore=0;const incorrectAnswers=[];questions.forEach((q,index)=>{const userAnswer=userAnswers[index]||"";let score=0;if(q.type==='spelling'){score=userAnswer.toLowerCase()===q.word.toLowerCase()?100:0}else{score=calculateMeaningScore(userAnswer,q.meaning)}
        if(score<100){incorrectAnswers.push({question:q.originalQuestion,userAnswer:userAnswer||"미응답",correctAnswer:q.type==='spelling'?q.word:q.meaning,score:score})}
        totalScore+=score});const averageScore=questions.length>0?Math.round(totalScore/questions.length):0;displayResults(averageScore,incorrectAnswers)}
        function calculateMeaningScore(userAnswer,correctAnswer){const normalize=str=>str.toLowerCase().replace(/[()]/g,'').trim();const cleanCorrectAnswer=correctAnswer.replace(/\d+\.\s*/g,'').trim();const cleanUserAnswer=userAnswer.trim();if(cleanUserAnswer==="")return 0;const meaningGroups=cleanCorrectAnswer.split(';').map(g=>g.trim().split(',').map(s=>normalize(s)).filter(s=>s));const userMeanings=cleanUserAnswer.split(/[,;]/).map(m=>normalize(m)).filter(m=>m);const allPossibleCorrectMeanings=new Set(meaningGroups.flat());for(const userMeaning of userMeanings){let isMeaningValid=false;for(const correctMeaning of allPossibleCorrectMeanings){if(correctMeaning.includes(userMeaning)||userMeaning.includes(correctMeaning)){isMeaningValid=true;break}}
        if(!isMeaningValid){return 0}}
        let matchedGroupsCount=0;for(const group of meaningGroups){let isGroupMatched=false;for(const userMeaning of userMeanings){for(const similarMeaning of group){if(similarMeaning.includes(userMeaning)||userMeaning.includes(similarMeaning)){isGroupMatched=true;break}}
        if(isGroupMatched)break}
        if(isGroupMatched){matchedGroupsCount++}}
        if(meaningGroups.length===0)return 100;const matchedRatio=matchedGroupsCount/meaningGroups.length;if(matchedRatio>=1){return 100}else if(matchedRatio>=0.5){return 50}else{return 0}}
        function displayResults(score,incorrectList){finalScore.textContent=score;const scoreContainer=finalScore.parentElement;scoreContainer.className='text-5xl font-bold text-center py-8 mb-6 rounded-lg';if(score>=80){scoreContainer.classList.add('text-blue-600')}else if(score>=50){scoreContainer.classList.add('text-yellow-600')}else{scoreContainer.classList.add('text-red-600')}
        incorrectAnswersBody.innerHTML='';if(incorrectList.length===0){incorrectAnswersBody.innerHTML=`<tr><td colspan="4" class="text-center py-4 text-gray-500">틀린 문제가 없습니다! 완벽해요!</td></tr>`}else{incorrectList.forEach(item=>{const row=`<tr class="text-sm"><td class="px-4 py-3 align-top">${item.question}</td><td class="px-4 py-3 align-top text-red-600">${item.userAnswer}</td><td class="px-4 py-3 align-top text-blue-600">${item.correctAnswer}</td><td class="px-4 py-3 align-top font-semibold">${item.score}점</td></tr>`;incorrectAnswersBody.innerHTML+=row})}
        showScreen(resultsScreen)}
        function showToast(message){const toast=document.getElementById('toast');toast.textContent=message;toast.classList.remove('opacity-0','translate-y-5');setTimeout(()=>{toast.classList.add('opacity-0','translate-y-5')},2500)}
        init();
    </script>
</body>
</html>

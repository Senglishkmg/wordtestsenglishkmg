<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>어휘끝 중학필수 단어 시험 (Unit 01-10)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .correct-flash { animation: flash-green 0.5s; }
        .incorrect-flash { animation: flash-red 0.5s; }
        @keyframes flash-green { 50% { box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.5); } }
        @keyframes flash-red { 50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.5); } }
        #toast { transition: opacity 0.3s, transform 0.3s; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen font-sans">

    <div id="app-container" class="w-full max-w-2xl mx-auto bg-white shadow-xl rounded-lg p-4 sm:p-8">

        <!-- 사용자 정보 입력 화면 -->
        <div id="user-info-screen">
            <h1 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">사용자 정보 입력</h1>
            <p class="text-center text-gray-600 mb-8">결과 저장에 사용될 정보를 입력해주세요.</p>
            <div class="space-y-4">
                <div>
                    <label for="school-input" class="block text-sm font-medium text-gray-700">학교</label>
                    <input type="text" id="school-input" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" placeholder="예: 새싹중학교">
                </div>
                <div>
                    <label for="grade-input" class="block text-sm font-medium text-gray-700">학년</label>
                    <input type="text" id="grade-input" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" placeholder="예: 1">
                </div>
                <div>
                    <label for="name-input" class="block text-sm font-medium text-gray-700">이름</label>
                    <input type="text" id="name-input" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" placeholder="예: 홍길동">
                </div>
            </div>
            <button id="start-app-button" class="w-full mt-8 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700">시험 시작하기</button>
        </div>

        <!-- 유닛 선택 화면 -->
        <div id="unit-selection-screen" class="hidden">
            <h1 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">어휘끝 중학필수 단어 시험</h1>
            <p class="text-center text-gray-600 mb-8">시험 볼 유닛을 선택하세요. (Unit 01-10)</p>
            <div id="unit-buttons" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>
        </div>

        <!-- 단어 시험 화면 -->
        <div id="test-screen" class="hidden">
            <div class="flex justify-between items-center mb-6"><h2 id="test-title" class="text-xl sm:text-2xl font-bold"></h2><div id="timer" class="text-lg font-semibold text-red-500 bg-red-100 px-4 py-2 rounded-lg">10:00</div></div>
            <div class="mb-6"><div class="w-full bg-gray-200 rounded-full h-2.5"><div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full"></div></div><p id="progress-text" class="text-center text-sm text-gray-600 mt-2"></p></div>
            <div id="question-container" class="text-center p-6 bg-gray-50 rounded-lg"><p id="question-type" class="text-sm font-semibold text-blue-600 mb-2"></p><p id="question" class="text-2xl sm:text-3xl font-medium mb-6 min-h-[72px] flex items-center justify-center"></p><input type="text" id="answer-input" class="w-full p-3 border rounded-lg text-lg text-center" placeholder="정답을 입력하세요"></div>
            <button id="next-button" class="w-full mt-6 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700">다음</button>
        </div>

        <!-- 채점 결과 화면 -->
        <div id="results-screen" class="hidden">
            <h2 class="text-2xl sm:text-3xl font-bold text-center mb-4">시험 결과</h2>
            <div id="score-container" class="text-5xl font-bold text-center py-8 mb-6 rounded-lg"><span id="final-score"></span><span class="text-3xl text-gray-500"> / 100</span></div>
            <h3 class="text-lg font-semibold mb-4">틀린 문제 목록</h3>
            <div class="overflow-x-auto border rounded-lg max-h-64">
                <table class="min-w-full divide-y"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-4 py-3 text-left text-xs font-medium uppercase">문제</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">제출한 답</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">정답</th><th class="px-4 py-3 text-left text-xs font-medium uppercase">점수</th></tr></thead><tbody id="incorrect-answers-body" class="bg-white divide-y"></tbody></table>
            </div>
            <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <button id="save-results-button" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg">결과 저장</button>
                <button id="retry-button" class="w-full bg-blue-500 text-white font-bold py-3 rounded-lg">다시 풀기</button>
                <button id="home-button" class="w-full bg-gray-500 text-white font-bold py-3 rounded-lg">처음으로</button>
            </div>
        </div>
    </div>
    <div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white px-5 py-3 rounded-lg shadow-lg opacity-0 transform translate-y-5"></div>
    <script>
        const vocabularyData = {
            "Unit 01": [
                { word: "appearance", meaning: "외모; 출현" }, { word: "image", meaning: "이미지, 인상" }, { word: "alike", meaning: "(아주) 비슷한" }, { word: "charm", meaning: "매력; 부적; 매혹하다" }, { word: "lovely", meaning: "사랑스러운" }, { word: "beauty", meaning: "아름다움; 미인" }, { word: "pretty", meaning: "예쁜; 매우, 꽤" }, { word: "cute", meaning: "귀여운" }, { word: "handsome", meaning: "잘생긴" }, { word: "plain", meaning: "꾸미지 않은; 쉬운; 못생긴" }, { word: "ugly", meaning: "못생긴, 미운" }, { word: "blond(e)", meaning: "금발의" }, { word: "curly", meaning: "곱슬곱슬한" }, { word: "beard", meaning: "턱수염" }, { word: "spot", meaning: "(피부의) 점, 반점; 장소" }, { word: "overweight", meaning: "과체중의" }, { word: "tall", meaning: "키가 큰; 높은" }, { word: "fat", meaning: "뚱뚱한" }, { word: "thin", meaning: "마른, 여윈; 얇은" }, { word: "slim", meaning: "날씬한" }, { word: "strong", meaning: "강한, 힘센" }, { word: "weak", meaning: "약한" }, { word: "pale", meaning: "창백한" }, { word: "young", meaning: "젊은, 어린" }, { word: "scent", meaning: "향기, 냄새" }
            ],
            "Unit 02": [
                { word: "emotion", meaning: "(희로애락의) 감정, 정서" }, { word: "glad", meaning: "기쁜" }, { word: "joy", meaning: "기쁨, 즐거움" }, { word: "happiness", meaning: "행복" }, { word: "funny", meaning: "재미있는, 웃기는" }, { word: "laugh", meaning: "(소리 내어) 웃다" }, { word: "smile", meaning: "미소 짓다; 웃음, 미소" }, { word: "surprise", meaning: "놀라게 하다; 놀라운 일" }, { word: "blue", meaning: "파란, 푸른; 우울한; 파란색" }, { word: "cry", meaning: "울다; 외치다" }, { word: "angry", meaning: "화난, 성난" }, { word: "mad", meaning: "미친, 정신 나간; 몹시 화가 난" }, { word: "upset", meaning: "화가 난; 속상하게 하다" }, { word: "fear", meaning: "공포, 무서움" }, { word: "afraid", meaning: "두려워하는, 염려하는" }, { word: "proud", meaning: "자랑스러운" }, { word: "respect", meaning: "존경하다; 존경, 존중" }, { word: "thank", meaning: "감사하다" }, { word: "hate", meaning: "싫어하다, 미워하다" }, { word: "lonely", meaning: "외로운" }, { word: "nervous", meaning: "불안해하는, 초조한" }, { word: "worry", meaning: "걱정하다, 걱정하게 만들다" }, { word: "serious", meaning: "진지한; 심각한, 나쁜" }, { word: "sorry", meaning: "미안한; 유감스러운" }, { word: "excuse", meaning: "용서하다; 변명" }
            ],
            "Unit 03": [
                { word: "skin", meaning: "피부" }, { word: "shoulder", meaning: "어깨" }, { word: "head", meaning: "머리, 고개; 향하다" }, { word: "face", meaning: "얼굴; 마주 보다" }, { word: "lip", meaning: "(위 또는 아래의) 입술" }, { word: "tooth", meaning: "이, 치아" }, { word: "hair", meaning: "머리카락; 털" }, { word: "neck", meaning: "목" }, { word: "arm", meaning: "팔" }, { word: "hand", meaning: "손; 건네주다" }, { word: "finger", meaning: "손가락" }, { word: "nail", meaning: "손톱, 발톱; 못; 못으로 고정하다" }, { word: "leg", meaning: "다리" }, { word: "heart", meaning: "심장" }, { word: "brain", meaning: "뇌; 지능" }, { word: "blood", meaning: "피, 혈액" }, { word: "bone", meaning: "뼈" }, { word: "breathe", meaning: "숨 쉬다, 호흡하다" }, { word: "hear", meaning: "들리다, 듣다" }, { word: "listen", meaning: "(귀 기울여) 듣다" }, { word: "sound", meaning: "(귀에 들리는) 소리; ~인 것 같다, ~처럼 들리다" }, { word: "voice", meaning: "목소리" }, { word: "smell", meaning: "냄새를 맡다; ~한 냄새가 나다; 냄새" }, { word: "touch", meaning: "만지다; 감동시키다" }, { word: "taste", meaning: "맛; 맛이 나다" }
            ],
            "Unit 04": [
                { word: "bore", meaning: "(말을 많이 해서) 지루하게 하다" }, { word: "dull", meaning: "따분한, 재미없는; (칼날 등이) 무딘" }, { word: "comfortable", meaning: "편안한" }, { word: "crazy", meaning: "미친; 열광하는" }, { word: "brave", meaning: "용감한, 씩씩한" }, { word: "honest", meaning: "정직한, 솔직한" }, { word: "calm", meaning: "차분한, 침착한" }, { word: "shy", meaning: "부끄러운, 수줍은" }, { word: "busy", meaning: "바쁜" }, { word: "hurry", meaning: "서두르다; 서두름, 급함" }, { word: "lazy", meaning: "게으른" }, { word: "alone", meaning: "혼자" }, { word: "wise", meaning: "현명한, 지혜로운" }, { word: "clever", meaning: "영리한, 똑똑한" }, { word: "sure", meaning: "확신하는" }, { word: "stupid", meaning: "어리석은" }, { word: "able", meaning: "~할 수 있는" }, { word: "thirst", meaning: "갈증" }, { word: "tire", meaning: "피로해지다, 피곤하게 만들다" }, { word: "hungry", meaning: "배고픈" }, { word: "alive", meaning: "살아 있는" }, { word: "lively", meaning: "활기 넘치는, 활발한" }, { word: "alright", meaning: "괜찮은" }, { word: "awake", meaning: "잠들지 않은, 깨어 있는" }, { word: "asleep", meaning: "잠이 든" }
            ],
            "Unit 05": [
                { word: "act", meaning: "행동, 행위; 행동하다" }, { word: "move", meaning: "(몸 등이) 움직이다; 이사하다" }, { word: "stand", meaning: "서다, 서 있다" }, { word: "sit", meaning: "앉다" }, { word: "lie", meaning: "누워 있다; 거짓말하다; 거짓말" }, { word: "hide", meaning: "감추다, 숨기다; 숨다" }, { word: "jump", meaning: "뛰다, 뛰어오르다" }, { word: "step", meaning: "(발)걸음; (발걸음을 떼서) 움직이다" }, { word: "follow", meaning: "따라오다, 따라가다" }, { word: "enter", meaning: "들어가다" }, { word: "pass", meaning: "지나가다; 건네주다; 합격하다" }, { word: "turn", meaning: "돌다, 돌리다; 차례" }, { word: "shout", meaning: "소리 지르다" }, { word: "bite", meaning: "물다, 깨물다" }, { word: "hit", meaning: "치다" }, { word: "break", meaning: "깨다, 부수다; 고장 내다; (짧은) 휴식" }, { word: "catch", meaning: "잡다" }, { word: "hold", meaning: "잡고 있다, 들다" }, { word: "carry", meaning: "나르다, 운반하다; 가지고 다니다" }, { word: "set", meaning: "차리다; ~을 두다, 놓다; 한 벌[조], 세트" }, { word: "close", meaning: "닫다; 가까운" }, { word: "cover", meaning: "덮다, 씌우다, 가리다" }, { word: "tear", meaning: "찢다, 뜯다; 눈물" }, { word: "pull", meaning: "잡아당기다" }, { word: "push", meaning: "밀다; 누르다" }
            ],
            "Unit 06": [
                { word: "household", meaning: "가정, 집안 식구" }, { word: "family", meaning: "가족, 가정" }, { word: "husband", meaning: "남편" }, { word: "wife", meaning: "아내, 부인" }, { word: "parent", meaning: "부모, 어버이, (-s) 양친" }, { word: "infant", meaning: "유아, 아기" }, { word: "child", meaning: "아이, 어린이; 자식" }, { word: "kid", meaning: "아이, 자녀; 농담하다" }, { word: "daughter", meaning: "딸" }, { word: "son", meaning: "아들" }, { word: "grandparent", meaning: "조부모, (-s) 조부모님" }, { word: "grandfather", meaning: "할아버지, 외할아버지" }, { word: "grandmother", meaning: "할머니, 외할머니" }, { word: "grandchild", meaning: "손주, 외손주" }, { word: "birth", meaning: "탄생, 출생" }, { word: "care", meaning: "염려하다, 마음을 쓰다; 돌보다; 주의, 조심, 배려; 돌봄; 걱정, 근심" }, { word: "marry", meaning: "결혼하다" }, { word: "adopt", meaning: "입양하다; (특정한 방식이나 태도를) 택하다" }, { word: "elder", meaning: "나이가 더 많은, 손윗사람인" }, { word: "twin", meaning: "쌍둥이; 쌍둥이의" }, { word: "relative", meaning: "친척; 비교상의, 상대적인" }, { word: "aunt", meaning: "이모, 고모, 숙모, 외숙모" }, { word: "cousin", meaning: "사촌" }, { word: "nephew", meaning: "(남자) 조카" }, { word: "niece", meaning: "(여자) 조카" }
            ],
            "Unit 07": [
                { word: "tool", meaning: "연장, 도구, 공구" }, { word: "needle", meaning: "바늘" }, { word: "pin", meaning: "(옷 등을 고정시키는 데 쓰는) 핀; (핀 등으로) 꽂다, 고정시키다" }, { word: "brush", meaning: "닦다; 붓, 솔" }, { word: "chain", meaning: "사슬, 쇠줄; (상점 등의) 체인점" }, { word: "hammer", meaning: "망치; 망치로 치다" }, { word: "scissors", meaning: "가위" }, { word: "basket", meaning: "바구니" }, { word: "frame", meaning: "틀, 액자; (건물 등의) 뼈대" }, { word: "match", meaning: "경기; 성냥; 어울리다" }, { word: "net", meaning: "그물, 망, 골문" }, { word: "rope", meaning: "밧줄, 로프" }, { word: "battery", meaning: "건전지, 배터리" }, { word: "board", meaning: "판자, -판; 위원회, 이사회; 탑승하다" }, { word: "bookshelf", meaning: "책꽂이, 책장" }, { word: "calendar", meaning: "달력" }, { word: "sheet", meaning: "침대 시트; (종이) 한 장" }, { word: "soap", meaning: "비누" }, { word: "towel", meaning: "수건, 타월" }, { word: "mirror", meaning: "거울; (거울처럼) 잘 보여주다, 반영하다" }, { word: "alarm", meaning: "경보(음), 경보기; 자명종" }, { word: "lamp", meaning: "램프, 등" }, { word: "candle", meaning: "양초" }, { word: "television", meaning: "텔레비전" }, { word: "umbrella", meaning: "우산, 양산" }
            ],
            "Unit 08": [
                { word: "kitchen", meaning: "부엌, 주방" }, { word: "bottle", meaning: "병" }, { word: "bowl", meaning: "그릇, 사발" }, { word: "dish", meaning: "접시, 그릇; 요리" }, { word: "glass", meaning: "유리; 유리잔" }, { word: "jar", meaning: "(잼·꿀 등을 담아 두는) 병" }, { word: "pan", meaning: "(손잡이가 달린 얕은) 냄비, 팬" }, { word: "pot", meaning: "냄비, 솥, 항아리" }, { word: "knife", meaning: "칼, 나이프" }, { word: "meat", meaning: "고기" }, { word: "beef", meaning: "소고기" }, { word: "pork", meaning: "돼지고기" }, { word: "vegetable", meaning: "채소, 야채" }, { word: "noodle", meaning: "국수, 면" }, { word: "bean", meaning: "콩" }, { word: "cabbage", meaning: "양배추" }, { word: "nut", meaning: "견과; 너트, 암나사" }, { word: "honey", meaning: "꿀, 벌꿀; <호칭> 여보, 자기" }, { word: "powder", meaning: "가루, 분말" }, { word: "pepper", meaning: "후추; 고추, 피망" }, { word: "bake", meaning: "(빵 등을) 굽다" }, { word: "boil", meaning: "끓다, 끓이다" }, { word: "burn", meaning: "(불이) 타오르다; 데다, 타다, 태우다" }, { word: "fry", meaning: "튀기다, (기름에) 굽다, 부치다" }, { word: "mix", meaning: "섞다, 혼합하다; 섞인 것, 혼합 가루" }
            ],
            "Unit 09": [
                { word: "usual", meaning: "일반적인, 일상의" }, { word: "ordinary", meaning: "평범한, 보통의" }, { word: "regular", meaning: "규칙적인, 정기적인; 보통의, 평상시의, 표준 크기의" }, { word: "routine", meaning: "일과; 일상적인" }, { word: "drive", meaning: "운전하다" }, { word: "exercise", meaning: "운동, 연습; 운동하다" }, { word: "contact", meaning: "연락; 접촉; 연락하다" }, { word: "habit", meaning: "습관, 버릇" }, { word: "diary", meaning: "일기" }, { word: "bath", meaning: "목욕; 욕조" }, { word: "shower", meaning: "샤워, 샤워기; 소나기; 샤워를 하다" }, { word: "wash", meaning: "씻다, 세탁하다" }, { word: "laundry", meaning: "세탁물, 빨래" }, { word: "iron", meaning: "다림질하다; 철, 쇠" }, { word: "lock", meaning: "잠그다; 자물쇠" }, { word: "tie", meaning: "(끈 등을) 묶다, 매다; 끈, 매듭; 넥타이" }, { word: "fix", meaning: "고치다; 고정하다" }, { word: "repair", meaning: "고치다, 수리하다; 수리" }, { word: "trash", meaning: "쓰레기" }, { word: "wipe", meaning: "닦다, 가볍게 문지르다" }, { word: "sweep", meaning: "쓸다, 청소하다" }, { word: "rest", meaning: "쉬다, 휴식을 취하다; 휴식, 수면" }, { word: "nap", meaning: "낮잠" }, { word: "sleep", meaning: "자다; 잠" }, { word: "wake", meaning: "(잠에서) 깨다, 깨우다" }
            ],
            "Unit 10": [
                { word: "fashion", meaning: "패션; 유행" }, { word: "design", meaning: "디자인하다, 고안하다; 디자인" }, { word: "model", meaning: "모델; (보통 실물보다 작게 만든) 모형" }, { word: "style", meaning: "스타일; 방식" }, { word: "item", meaning: "항목; 물품, 품목" }, { word: "brand", meaning: "상표, 브랜드" }, { word: "magazine", meaning: "잡지, 매거진" }, { word: "clothes", meaning: "옷, 의복" }, { word: "dress", meaning: "드레스, 원피스" }, { word: "jacket", meaning: "재킷, (짧은) 상의" }, { word: "pants", meaning: "바지" }, { word: "jeans", meaning: "청바지" }, { word: "shirt", meaning: "셔츠" }, { word: "cotton", meaning: "면, 솜; 목화" }, { word: "pocket", meaning: "주머니" }, { word: "button", meaning: "단추" }, { word: "scarf", meaning: "스카프" }, { word: "purse", meaning: "(여성용) 지갑" }, { word: "wallet", meaning: "지갑" }, { word: "ring", meaning: "고리; 반지; (종 등을) 울리다" }, { word: "glove(s)", meaning: "장갑" }, { word: "socks", meaning: "양말" }, { word: "shoes", meaning: "신발" }, { word: "boot(s)", meaning: "목이 긴 신발[구두], 부츠" }, { word: "wear", meaning: "입고[신고·쓰고] 있다" }
            ]
        };
        // --- 이하 스크립트 코드는 이전 앱들과 동일 ---
        let userInfo = {};
        let currentUnit='',questions=[],currentQuestionIndex=0,userAnswers=[],timerInterval;
        const userInfoScreen = document.getElementById('user-info-screen');
        const unitSelectionScreen=document.getElementById('unit-selection-screen');
        const testScreen=document.getElementById('test-screen');
        const resultsScreen=document.getElementById('results-screen');
        const schoolInput = document.getElementById('school-input');
        const gradeInput = document.getElementById('grade-input');
        const nameInput = document.getElementById('name-input');
        const startAppButton = document.getElementById('start-app-button');
        const unitButtonsContainer=document.getElementById('unit-buttons');
        const testTitle=document.getElementById('test-title');
        const timerDisplay=document.getElementById('timer');
        const progressBar=document.getElementById('progress-bar');
        const progressText=document.getElementById('progress-text');
        const questionType=document.getElementById('question-type');
        const questionEl=document.getElementById('question');
        const answerInput=document.getElementById('answer-input');
        const nextButton=document.getElementById('next-button');
        const finalScore=document.getElementById('final-score');
        const incorrectAnswersBody=document.getElementById('incorrect-answers-body');
        const saveResultsButton=document.getElementById('save-results-button');
        const retryButton=document.getElementById('retry-button');
        const homeButton=document.getElementById('home-button');
        
        function init(){
            Object.keys(vocabularyData).sort((a,b)=>parseInt(a.match(/\d+/)[0])-parseInt(b.match(/\d+/)[0])).forEach(unit=>{const button=document.createElement('button');button.textContent=unit;button.className='bg-white text-gray-700 font-semibold py-4 px-2 rounded-lg shadow hover:bg-gray-200 border border-gray-200 transition-all duration-200';button.onclick=()=>startTest(unit);unitButtonsContainer.appendChild(button)});
            startAppButton.addEventListener('click', startApp);
            nextButton.addEventListener('click',handleNext);
            answerInput.addEventListener('keyup',e=>{if(e.key==='Enter'){handleNext()}});
            retryButton.addEventListener('click',()=>startTest(currentUnit));
            homeButton.addEventListener('click',()=>showScreen(unitSelectionScreen));
            saveResultsButton.addEventListener('click',saveResults);
            showScreen(userInfoScreen);
        }

        function startApp() {
            const school = schoolInput.value.trim();
            const grade = gradeInput.value.trim();
            const name = nameInput.value.trim();
            if (!school || !grade || !name) {
                showToast("모든 정보를 입력해주세요.");
                return;
            }
            userInfo = { school, grade, name };
            showScreen(unitSelectionScreen);
        }

        function showScreen(screen){
            [userInfoScreen, unitSelectionScreen,testScreen,resultsScreen].forEach(s=>s.classList.add('hidden'));
            screen.classList.remove('hidden');
        }

        async function saveResults(){
            const score=finalScore.textContent;
            let title = `${userInfo.school} ${userInfo.grade}학년 ${userInfo.name}의 ${currentUnit} 시험지`;
            let resultsText = `${title}\n\n총점: ${score}점\n\n--- 틀린 문제 목록 ---\n`;
            const incorrectRows=incorrectAnswersBody.querySelectorAll('tr');
            if(incorrectRows.length===1&&incorrectRows[0].children[0].colSpan===4){
                resultsText+="틀린 문제가 없습니다."
            } else {
                incorrectRows.forEach(row=>{
                    const cells=row.querySelectorAll('td');
                    resultsText+=`문제: ${cells[0].textContent}\n`;
                    resultsText+=`제출 답: ${cells[1].textContent}\n`;
                    resultsText+=`정답: ${cells[2].textContent}\n`;
                    resultsText+=`점수: ${cells[3].textContent}\n\n`;
                });
            }
            try{
                await navigator.clipboard.writeText(resultsText.trim());
                showToast('시험 결과가 클립보드에 복사되었습니다.');
            } catch(err) {
                console.error('클립보드 복사 실패:',err);
                showToast('결과 복사에 실패했습니다.');
            }
        }
        
        function startTest(unit){currentUnit=unit;let unitWords=[...vocabularyData[unit]];questions=[];userAnswers=[];currentQuestionIndex=0;unitWords.sort(()=>0.5-Math.random());const numQuestions=Math.min(20,unitWords.length);const selectedWords=unitWords.slice(0,numQuestions);const half=Math.ceil(numQuestions/2);for(let i=0;i<numQuestions;i++){const wordData=selectedWords[i];const type=i<half?'spelling':'meaning';questions.push({type:type,word:wordData.word,meaning:wordData.meaning,originalQuestion:type==='spelling'?wordData.meaning:wordData.word})}
        questions.sort(()=>0.5-Math.random());testTitle.textContent=`${unit} 단어 시험`;showScreen(testScreen);displayQuestion();startTimer()}
        function displayQuestion(){if(currentQuestionIndex>=questions.length){submitTest();return}
        const q=questions[currentQuestionIndex];if(q.type==='spelling'){questionType.textContent='의미를 보고 철자 맞히기';questionEl.textContent=q.meaning.replace(/(\d+\.\s*)|[()]/g,'').replace(/;/g,', ')}else{questionType.textContent='철자를 보고 의미 맞히기';questionEl.textContent=q.word}
        answerInput.value='';answerInput.focus();updateProgress();if(currentQuestionIndex===questions.length-1){nextButton.textContent='채점하기'}else{nextButton.textContent='다음'}}
        function handleNext(){const answer=answerInput.value.trim();if(!answer){answerInput.classList.add('incorrect-flash');setTimeout(()=>answerInput.classList.remove('incorrect-flash'),500);return}
        userAnswers[currentQuestionIndex]=answer;const isCorrectAnswer=isAnswerInitiallyCorrect(questions[currentQuestionIndex],answer);answerInput.classList.add(isCorrectAnswer?'correct-flash':'incorrect-flash');setTimeout(()=>answerInput.classList.remove('correct-flash','incorrect-flash'),500);setTimeout(()=>{currentQuestionIndex++;displayQuestion()},300)}
        function isAnswerInitiallyCorrect(question,answer){if(question.type==='spelling'){return question.word.toLowerCase()===answer.toLowerCase()}else{const cleanCorrectAnswer=question.meaning.toLowerCase().replace(/(\d+\.\s*)|[()]/g,'');const userFirstMeaning=answer.split(/[,;]/)[0].toLowerCase().trim();return cleanCorrectAnswer.includes(userFirstMeaning)}}
        function updateProgress(){const progress=((currentQuestionIndex)/questions.length)*100;progressBar.style.width=`${progress}%`;progressText.textContent=`문제 ${currentQuestionIndex+1} / ${questions.length}`}
        function startTimer(){let timeLeft=600;timerDisplay.textContent="10:00";clearInterval(timerInterval);timerInterval=setInterval(()=>{timeLeft--;const minutes=Math.floor(timeLeft/60);const seconds=timeLeft%60;timerDisplay.textContent=`${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;if(timeLeft<=0){clearInterval(timerInterval);submitTest()}},1000)}
        function submitTest(){clearInterval(timerInterval);let totalScore=0;const incorrectAnswers=[];questions.forEach((q,index)=>{const userAnswer=userAnswers[index]||"";let score=0;if(q.type==='spelling'){score=userAnswer.toLowerCase()===q.word.toLowerCase()?100:0}else{score=calculateMeaningScore(userAnswer,q.meaning)}
        if(score<100){incorrectAnswers.push({question:q.originalQuestion,userAnswer:userAnswer||"미응답",correctAnswer:q.type==='spelling'?q.word:q.meaning,score:score})}
        totalScore+=score});const averageScore=questions.length>0?Math.round(totalScore/questions.length):0;displayResults(averageScore,incorrectAnswers)}
        function calculateMeaningScore(userAnswer,correctAnswer){const normalize=str=>str.toLowerCase().replace(/[()]/g,'').trim();const cleanCorrectAnswer=correctAnswer.replace(/\d+\.\s*/g,'').trim();const cleanUserAnswer=userAnswer.trim();if(cleanUserAnswer==="")return 0;const meaningGroups=cleanCorrectAnswer.split(';').map(g=>g.trim().split(',').map(s=>normalize(s)).filter(s=>s));const userMeanings=cleanUserAnswer.split(/[,;]/).map(m=>normalize(m)).filter(m=>m);const allPossibleCorrectMeanings=new Set(meaningGroups.flat());for(const userMeaning of userMeanings){let isMeaningValid=false;for(const correctMeaning of allPossibleCorrectMeanings){if(correctMeaning.includes(userMeaning)||userMeaning.includes(correctMeaning)){isMeaningValid=true;break}}
        if(!isMeaningValid){return 0}}
        let matchedGroupsCount=0;for(const group of meaningGroups){let isGroupMatched=false;for(const userMeaning of userMeanings){for(const similarMeaning of group){if(similarMeaning.includes(userMeaning)||userMeaning.includes(similarMeaning)){isGroupMatched=true;break}}
        if(isGroupMatched)break}
        if(isGroupMatched){matchedGroupsCount++}}
        if(meaningGroups.length===0)return 100;const matchedRatio=matchedGroupsCount/meaningGroups.length;if(matchedRatio>=1){return 100}else if(matchedRatio>=0.5){return 50}else{return 0}}
        function displayResults(score,incorrectList){finalScore.textContent=score;const scoreContainer=finalScore.parentElement;scoreContainer.className='text-5xl font-bold text-center py-8 mb-6 rounded-lg';if(score>=80){scoreContainer.classList.add('text-blue-600')}else if(score>=50){scoreContainer.classList.add('text-yellow-600')}else{scoreContainer.classList.add('text-red-600')}
        incorrectAnswersBody.innerHTML='';if(incorrectList.length===0){incorrectAnswersBody.innerHTML=`<tr><td colspan="4" class="text-center py-4 text-gray-500">틀린 문제가 없습니다! 완벽해요!</td></tr>`}else{incorrectList.forEach(item=>{const row=`<tr class="text-sm"><td class="px-4 py-3 align-top">${item.question}</td><td class="px-4 py-3 align-top text-red-600">${item.userAnswer}</td><td class="px-4 py-3 align-top text-blue-600">${item.correctAnswer}</td><td class="px-4 py-3 align-top font-semibold">${item.score}점</td></tr>`;incorrectAnswersBody.innerHTML+=row})}
        showScreen(resultsScreen)}
        function showToast(message){const toast=document.getElementById('toast');toast.textContent=message;toast.classList.remove('opacity-0','translate-y-5');setTimeout(()=>{toast.classList.add('opacity-0','translate-y-5')},2500)}
        init();
    </script>
</body>
</html>

